import{w as $}from"./with-props-Ddy16cIg.js";import{a as n,n as e,o as R,L as m,M as I,p as T,S as B,q as D,O as G}from"./chunk-IR6S3I6Y-BEDlfGdp.js";import{u as z,G as U,U as F}from"./UserContext-D65-sANx.js";import{M as V,u as M,P as W,a as q,b as A,L as H}from"./use-isomorphic-effect-Aaqhzf0Z.js";class K extends n.Component{getSnapshotBeforeUpdate(a){const s=this.props.childRef.current;if(s&&a.isPresent&&!this.props.isPresent){const r=s.offsetParent,t=r instanceof HTMLElement&&r.offsetWidth||0,o=this.props.sizeRef.current;o.height=s.offsetHeight||0,o.width=s.offsetWidth||0,o.top=s.offsetTop,o.left=s.offsetLeft,o.right=t-o.width-o.left}return null}componentDidUpdate(){}render(){return this.props.children}}function J({children:i,isPresent:a,anchorX:s}){const r=n.useId(),t=n.useRef(null),o=n.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:d}=n.useContext(V);return n.useInsertionEffect(()=>{const{width:u,height:l,top:y,left:c,right:g}=o.current;if(a||!t.current||!u||!l)return;const p=s==="left"?`left: ${c}`:`right: ${g}`;t.current.dataset.motionPopId=r;const x=document.createElement("style");return d&&(x.nonce=d),document.head.appendChild(x),x.sheet&&x.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${u}px !important;
            height: ${l}px !important;
            ${p}px !important;
            top: ${y}px !important;
          }
        `),()=>{document.head.removeChild(x)}},[a]),e.jsx(K,{isPresent:a,childRef:t,sizeRef:o,children:n.cloneElement(i,{ref:t})})}const X=({children:i,initial:a,isPresent:s,onExitComplete:r,custom:t,presenceAffectsLayout:o,mode:d,anchorX:u})=>{const l=M(Y),y=n.useId(),c=n.useCallback(p=>{l.set(p,!0);for(const x of l.values())if(!x)return;r&&r()},[l,r]),g=n.useMemo(()=>({id:y,initial:a,isPresent:s,custom:t,onExitComplete:c,register:p=>(l.set(p,!1),()=>l.delete(p))}),o?[Math.random(),c]:[s,c]);return n.useMemo(()=>{l.forEach((p,x)=>l.set(x,!1))},[s]),n.useEffect(()=>{!s&&!l.size&&r&&r()},[s]),d==="popLayout"&&(i=e.jsx(J,{isPresent:s,anchorX:u,children:i})),e.jsx(W.Provider,{value:g,children:i})};function Y(){return new Map}const w=i=>i.key||"";function P(i){const a=[];return n.Children.forEach(i,s=>{n.isValidElement(s)&&a.push(s)}),a}const Q=({children:i,custom:a,initial:s=!0,onExitComplete:r,presenceAffectsLayout:t=!0,mode:o="sync",propagate:d=!1,anchorX:u="left"})=>{const[l,y]=q(d),c=n.useMemo(()=>P(i),[i]),g=d&&!l?[]:c.map(w),p=n.useRef(!0),x=n.useRef(c),j=M(()=>new Map),[S,O]=n.useState(c),[b,L]=n.useState(c);A(()=>{p.current=!1,x.current=c;for(let f=0;f<b.length;f++){const h=w(b[f]);g.includes(h)?j.delete(h):j.get(h)!==!0&&j.set(h,!1)}},[b,g.length,g.join("-")]);const k=[];if(c!==S){let f=[...c];for(let h=0;h<b.length;h++){const v=b[h],N=w(v);g.includes(N)||(f.splice(h,0,v),k.push(v))}return o==="wait"&&k.length&&(f=k),L(P(f)),O(c),null}const{forceRender:C}=n.useContext(H);return e.jsx(e.Fragment,{children:b.map(f=>{const h=w(f),v=d&&!l?!1:c===b||g.includes(h),N=()=>{if(j.has(h))j.set(h,!0);else return;let E=!0;j.forEach(_=>{_||(E=!1)}),E&&(C==null||C(),L(x.current),d&&(y==null||y()),r&&r())};return e.jsx(X,{isPresent:v,initial:!p.current||s?void 0:!1,custom:a,presenceAffectsLayout:t,mode:o,onExitComplete:v?void 0:N,anchorX:u,children:f},h)})})},Z=({isScrolled:i=!1,gradientStyle:a={}})=>{const[s,r]=n.useState(!1),{user:t,logout:o}=z(),d=R(),u=()=>{o(),d("/")},l=()=>t?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"hidden sm:flex sm:items-center sm:space-x-6",children:[t.is_organization&&e.jsx(m,{to:"/opportunities/create",className:"px-4 py-2 text-sm font-medium rounded-full text-white bg-green-600 hover:bg-green-700",children:"Create Opportunity"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[t.email,t.is_organization&&e.jsx("span",{className:"ml-2 px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full",children:"Organization"})]}),e.jsx(m,{to:"/dashboard",className:"px-3 py-2 text-sm font-medium text-gray-600 hover:text-gray-900",children:t.is_organization?"Organization Dashboard":"Volunteer Dashboard"}),e.jsx("button",{onClick:u,className:"px-3 py-2 text-sm font-medium text-red-600 hover:text-red-900",children:"Logout"})]})}):e.jsxs("div",{className:"hidden sm:flex sm:items-center sm:space-x-6",children:[e.jsx(m,{to:"/browse",className:"px-3 py-2 text-sm font-medium text-gray-600 hover:text-gray-900",children:"Browse"}),e.jsx(m,{to:"/login",className:"px-3 py-2 text-sm font-medium text-gray-600 hover:text-gray-900",children:"Login"}),e.jsx(m,{to:"/register",className:"ml-2 px-4 py-2 text-sm font-medium rounded-full text-white bg-gray-900 hover:bg-gray-800",children:"Register"})]});return e.jsxs("nav",{className:"bg-white/80 backdrop-blur-sm border-b border-gray-100 fixed w-full z-50",children:[e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between h-16",children:[e.jsx("div",{className:"flex",children:e.jsx(m,{to:"/",className:"flex-shrink-0 flex items-center",children:e.jsx("span",{className:`transition-all duration-500 transform ${i?"animate-gradient bg-gradient-to-r from-blue-600 via-green-500 to-blue-600 bg-[length:200%_auto] bg-clip-text text-transparent text-xl font-semibold":"text-xl font-semibold text-gray-900"}`,style:i?a:{},children:"Volunteera"})})}),l(),e.jsx("div",{className:"sm:hidden flex items-center",children:e.jsxs("button",{onClick:()=>r(!s),className:"inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100",children:[e.jsx("span",{className:"sr-only",children:"Open main menu"}),e.jsx("svg",{className:`${s?"hidden":"block"} h-6 w-6`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})}),e.jsx("svg",{className:`${s?"block":"hidden"} h-6 w-6`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})})]})}),e.jsx("div",{className:`${s?"block":"hidden"} sm:hidden`,children:e.jsx("div",{className:"pt-2 pb-3 space-y-1",children:t?e.jsxs(e.Fragment,{children:[t.is_organization&&e.jsx(m,{to:"/opportunities/create",className:"block px-3 py-2 text-base font-medium text-white bg-green-600 hover:bg-green-700",children:"Create Opportunity"}),e.jsx("span",{className:"block px-3 py-2 text-base font-medium text-gray-700",children:t.email}),t.is_organization&&e.jsx("span",{className:"block px-3 py-1 text-sm text-blue-800 bg-blue-100",children:"Organization"}),e.jsx(m,{to:"/dashboard",className:"block px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50",children:t.is_organization?"Organization Dashboard":"Volunteer Dashboard"}),e.jsx("button",{onClick:u,className:"block w-full text-left px-3 py-2 text-base font-medium text-red-600 hover:text-red-900 hover:bg-gray-50",children:"Logout"})]}):e.jsxs(e.Fragment,{children:[e.jsx(m,{to:"/browse",className:"block px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50",children:"Browse"}),e.jsx(m,{to:"/login",className:"block px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50",children:"Login"}),e.jsx(m,{to:"/register",className:"block px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50",children:"Register"})]})})})]})},ee=()=>{const i=R(),{login:a}=z();n.useEffect(()=>{var r,t;localStorage.getItem("access_token")||((r=window.google)==null||r.accounts.id.initialize({client_id:"1032409090840-gus43isikcnuq4n365l7gocm53h725dl.apps.googleusercontent.com",callback:s,auto_select:!0,cancel_on_tap_outside:!1}),(t=window.google)==null||t.accounts.id.prompt())},[]);const s=async r=>{try{const t=await fetch("/api/auth/google/callback/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({credential:r.credential,user_type:"volunteer"})});if(!t.ok)throw new Error("Login failed");const o=await t.json();localStorage.setItem("access_token",o.access),localStorage.setItem("refresh_token",o.refresh),a(o.user),i("/dashboard")}catch(t){console.error("Google One Tap error:",t)}};return null};function oe({children:i}){return e.jsxs("html",{lang:"en",children:[e.jsxs("head",{children:[e.jsx("meta",{charSet:"UTF-8"}),e.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0"}),e.jsx("title",{children:"Volunterra"}),e.jsx(I,{}),e.jsx(T,{})]}),e.jsxs("body",{children:[i,e.jsx(B,{}),e.jsx(D,{})]})]})}const ie=$(function(){const[a,s]=n.useState(!1),[r,t]=n.useState(0);n.useEffect(()=>{const d=()=>{const u=window.scrollY;s(u>50),t(u*.2)};return window.addEventListener("scroll",d),()=>window.removeEventListener("scroll",d)},[]);const o={backgroundPosition:`${r}% 50%`};return e.jsx(U,{clientId:"1032409090840-gus43isikcnuq4n365l7gocm53h725dl.apps.googleusercontent.com",children:e.jsx(F,{children:e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Z,{isScrolled:a,gradientStyle:o}),e.jsx(ee,{}),e.jsx(Q,{mode:"wait",children:e.jsx("main",{className:"pt-16",children:e.jsx(G,{})})})]})})})});export{oe as Layout,ie as default};
