import{w as C}from"./with-props-BqwZr1IK.js";import{r as l,j as e,L as D}from"./chunk-IR6S3I6Y-C6Zvu3tq.js";import{F as S}from"./index-DDJz-nCr.js";import{P as O}from"./PageTransition-1p6Ne89E.js";import{S as m}from"./LoadingSpinner-CGbvDqwE.js";import{a as u}from"./api-BXsSQKvn.js";import"./proxy-7hmYPAw3.js";const h=({type:a})=>{const o={companiesHouse:{label:"UK Companies House Verified",color:"bg-blue-50 text-blue-700 border border-blue-200"},charitiesCommission:{label:"UK Charity Commission Verified",color:"bg-purple-50 text-purple-700 border border-purple-200"}}[a];return e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${o.color} gap-1.5`,title:o.label,children:[o.label,e.jsx(S,{className:"w-3 h-3"})]})},L=({opportunity:a})=>e.jsx("div",{className:"opportunity",children:e.jsx("div",{className:"bg-white rounded-xl shadow-sm hover:shadow-md transition-shadow duration-200",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl",children:a.image||"📋"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:a.title}),e.jsx("p",{className:"text-sm text-gray-500",children:a.organization.name})]}),e.jsxs("h4",{className:"text-sm text-gray-500",children:["Effort: ",a.effort]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.organization.companiesHouseVerified&&e.jsx(h,{type:"companiesHouse"}),a.organization.charitiesCommissionVerified&&e.jsx(h,{type:"charitiesCommission"})]})]}),e.jsx("p",{className:"mt-4 text-gray-600",children:a.description}),a.tags&&e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:a.tags.map((r,o)=>e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:r},o))}),e.jsxs("div",{className:"mt-6 flex justify-between items-center",children:[e.jsx("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"📍"})," ",a.location_name]})}),e.jsx(D,{to:`/opportunity/${a.id}`,className:"inline-flex items-center px-4 py-2 text-sm font-medium rounded-full text-white bg-gray-900 hover:bg-gray-800 transition-colors",children:"Learn More"})]})]})})}),_=()=>{const[a,r]=l.useState([]),[o,c]=l.useState(!0),[g,f]=l.useState([]),[E,y]=l.useState([...a]);console.log(a);function j(){let s=document.getElementById("searchBar").value.toLowerCase();document.querySelectorAll(".opportunity").forEach(t=>{t.textContent.toLowerCase().includes(s)?t.style.display="block":t.style.display="none"})}l.useEffect(()=>{d()},[]);async function d(){try{c(!0);const s=await u.get("/opportunities/");r(s)}catch(s){console.error("Error fetching opportunities:",s)}finally{c(!1)}}async function N(s){let n=[...a];s==="Closest Deadline"?r(a.sort((t,i)=>new Date(t.end_date)-new Date(i.end_date))):s==="Furthest Deadline"?r(a.sort((t,i)=>new Date(i.end_date)-new Date(t.end_date))):s==="Newest"?r(a.sort((t,i)=>new Date(i.date_created)-new Date(t.date_created))):s==="Oldest"?r(a.sort((t,i)=>new Date(t.date_created)-new Date(i.date_created))):s==="Largest Capacity"?r(a.sort((t,i)=>t.capacity-i.capacity)):s==="Smallest Capacity"?r(a.sort((t,i)=>i.capacity-t.capacity)):s==="Close to Capacity"?r(a.sort((t,i)=>t.capacity-t.current_count-(i.capacity-i.current_count))):s==="Low to High Duration"?r(a.sort((t,i)=>t.duration-i.duration)):s==="High to Low Duration"?r(a.sort((t,i)=>i.duration-t.duration)):d(),y(n)}l.useEffect(()=>{(async()=>{try{c(!0);const n=await u.get("/categories/");f(n)}catch(n){console.error("Error fetching categories:",n)}finally{c(!1)}})()},[]);function v(s){let n=[];a.forEach(t=>{t.categories.includes(s)&&n.push(t)}),r(n)}function w(){d()}const[x,p]=l.useState({postcode:null,max_distance:null}),b=async s=>{s.preventDefault();try{const n=await fetch("/api/opportunities/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)});if(!n.ok){const i=await n.json();throw new Error(i.error||"Registration failed")}const t=await n.json();r(t),localStorage.setItem("token",t.access),localStorage.setItem("refreshToken",t.refresh),localStorage.setItem("user",JSON.stringify(t.user))}catch{}};return e.jsx(O,{children:e.jsx("div",{className:"min-h-screen bg-white -mt-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-semibold text-gray-900",children:"Discover Opportunities"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Explore volunteer opportunities near you"})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[e.jsx("div",{className:"lg:w-64 flex-shrink-0",children:e.jsxs("div",{className:"sticky top-24 space-y-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Categories"}),e.jsx("div",{className:"space-y-2",children:o?e.jsx("div",{className:"col-span-2 text-center py-12",children:e.jsx(m,{})}):e.jsxs("div",{children:[g.map(s=>e.jsx("div",{className:"w-full",children:e.jsx("label",{className:"w-full",children:e.jsxs("button",{onClick:()=>v(s.name),name:s.name,className:"w-full flex items-center px-4 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-50 rounded-lg transition-colors",children:[" ",s.name," ",e.jsx("span",{className:"text-gray-400 ml-auto",children:s.count})]})})},s.id)),e.jsx("button",{onClick:w,className:"bg-white-500 text-grey px-4 py-2 rounded mt-2 w-full hover:bg-gray-50",children:"Clear Filters"})]})})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Location"}),e.jsxs("form",{className:"space-y-2",onSubmit:b,children:[e.jsx("input",{id:"user_postcode",type:"text",placeholder:"Your Postcode...",className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-200",onChange:s=>p({...x,postcode:s.target.value})}),e.jsx("input",{id:"max_distance",type:"number",placeholder:"Distance in km...",className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-200",onChange:s=>p({...x,max_distance:s.target.value})}),e.jsx("button",{className:"hover:cursor-pointer bg-white-500 text-grey px-4 py-2 rounded mt-2 w-full hover:bg-gray-50",type:"submit",children:"Submit"})]})]})]})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{id:"searchBar",type:"text",onKeyUp:j,placeholder:"Search opportunities...",className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-200"})}),e.jsx("div",{children:e.jsxs("select",{onChange:s=>N(s.target.value),className:"px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-200 hover:cursor-pointer",children:[e.jsx("option",{value:"",children:"Sort By"}),e.jsx("option",{value:"Closest Deadline",children:"Closest Deadline"}),e.jsx("option",{value:"Furthest Deadline",children:"Furthest Deadline"}),e.jsx("option",{value:"Newest",children:"Newest"}),e.jsx("option",{value:"Oldest",children:"Oldest"}),e.jsx("option",{value:"Largest Capacity",children:"Largest Capacity"}),e.jsx("option",{value:"Smallest Capacity",children:"Smallest Capacity"}),e.jsx("option",{value:"Close to Capacity",children:"Close to Capacity"}),e.jsx("option",{value:"Low to High Duration",children:"Shortest Duration"}),e.jsx("option",{value:"High to Low Duration",children:"Longest Duration"})]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:o?e.jsx("div",{className:"col-span-2 text-center py-12",children:e.jsx(m,{})}):a.length===0?e.jsx("div",{className:"col-span-2 text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"No opportunities found"})}):a.map(s=>e.jsx(L,{opportunity:s},s.id))})]})]})]})})})},T=C(_);export{T as default};
