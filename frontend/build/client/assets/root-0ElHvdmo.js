import{M as T,u as P,P as $,a as I,b as B,L as G,m as R,w as W}from"./proxy-Bff0xxqS.js";import{a as s,n as e,L as m,o as U,M as V,p as D,S as F,q as H,O as A}from"./chunk-IR6S3I6Y-BEDlfGdp.js";import{u as E,a as Y,G as q,U as K}from"./UserContext-DHqOuuyH.js";class J extends s.Component{getSnapshotBeforeUpdate(a){const t=this.props.childRef.current;if(t&&a.isPresent&&!this.props.isPresent){const i=t.offsetParent,l=i instanceof HTMLElement&&i.offsetWidth||0,r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft,r.right=l-r.width-r.left}return null}componentDidUpdate(){}render(){return this.props.children}}function X({children:n,isPresent:a,anchorX:t}){const i=s.useId(),l=s.useRef(null),r=s.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:o}=s.useContext(T);return s.useInsertionEffect(()=>{const{width:x,height:c,top:p,left:d,right:g}=r.current;if(a||!l.current||!x||!c)return;const f=t==="left"?`left: ${d}`:`right: ${g}`;l.current.dataset.motionPopId=i;const u=document.createElement("style");return o&&(u.nonce=o),document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${x}px !important;
            height: ${c}px !important;
            ${f}px !important;
            top: ${p}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[a]),e.jsx(J,{isPresent:a,childRef:l,sizeRef:r,children:s.cloneElement(n,{ref:l})})}const Q=({children:n,initial:a,isPresent:t,onExitComplete:i,custom:l,presenceAffectsLayout:r,mode:o,anchorX:x})=>{const c=P(Z),p=s.useId(),d=s.useCallback(f=>{c.set(f,!0);for(const u of c.values())if(!u)return;i&&i()},[c,i]),g=s.useMemo(()=>({id:p,initial:a,isPresent:t,custom:l,onExitComplete:d,register:f=>(c.set(f,!1),()=>c.delete(f))}),r?[Math.random(),d]:[t,d]);return s.useMemo(()=>{c.forEach((f,u)=>c.set(u,!1))},[t]),s.useEffect(()=>{!t&&!c.size&&i&&i()},[t]),o==="popLayout"&&(n=e.jsx(X,{isPresent:t,anchorX:x,children:n})),e.jsx($.Provider,{value:g,children:n})};function Z(){return new Map}const w=n=>n.key||"";function M(n){const a=[];return s.Children.forEach(n,t=>{s.isValidElement(t)&&a.push(t)}),a}const ee=({children:n,custom:a,initial:t=!0,onExitComplete:i,presenceAffectsLayout:l=!0,mode:r="sync",propagate:o=!1,anchorX:x="left"})=>{const[c,p]=I(o),d=s.useMemo(()=>M(n),[n]),g=o&&!c?[]:d.map(w),f=s.useRef(!0),u=s.useRef(d),j=P(()=>new Map),[O,z]=s.useState(d),[b,L]=s.useState(d);B(()=>{f.current=!1,u.current=d;for(let y=0;y<b.length;y++){const h=w(b[y]);g.includes(h)?j.delete(h):j.get(h)!==!0&&j.set(h,!1)}},[b,g.length,g.join("-")]);const N=[];if(d!==O){let y=[...d];for(let h=0;h<b.length;h++){const v=b[h],C=w(v);g.includes(C)||(y.splice(h,0,v),N.push(v))}return r==="wait"&&N.length&&(y=N),L(M(y)),z(d),null}const{forceRender:k}=s.useContext(G);return e.jsx(e.Fragment,{children:b.map(y=>{const h=w(y),v=o&&!c?!1:d===b||g.includes(h),C=()=>{if(j.has(h))j.set(h,!0);else return;let S=!0;j.forEach(_=>{_||(S=!1)}),S&&(k==null||k(),L(u.current),o&&(p==null||p()),i&&i())};return e.jsx(Q,{isPresent:v,initial:!f.current||t?void 0:!1,custom:a,presenceAffectsLayout:l,mode:r,onExitComplete:v?void 0:C,anchorX:x,children:y},h)})})},te=({isScrolled:n=!1,gradientStyle:a={}})=>{const{user:t,logout:i}=E(),[l,r]=s.useState(!1),[o,x]=s.useState(!1),[c,p]=s.useState(!1);s.useEffect(()=>{const g=setTimeout(()=>{x(!0)},1e3);return()=>clearTimeout(g)},[]);const d=()=>{i()};return e.jsxs("nav",{className:"fixed w-full z-50",children:[e.jsx(R.div,{initial:{scaleY:0},animate:{scaleY:o?1:0,opacity:o?1:0},transition:{duration:.8,ease:"easeOut"},className:"h-1 w-full bg-gradient-to-r from-blue-500 via-emerald-400 to-blue-500 bg-[length:200%_auto] animate-gradient"}),e.jsx("div",{className:"bg-white/80 backdrop-blur-sm border-b border-gray-100",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between h-16",children:[e.jsx("div",{className:"flex",children:e.jsx(m,{to:"/",className:"flex-shrink-0 flex items-center",children:e.jsx("span",{className:`transition-all duration-500 transform ${n?"animate-gradient bg-gradient-to-r from-blue-600 via-green-500 to-blue-600 bg-[length:200%_auto] bg-clip-text text-transparent text-xl font-semibold":"text-xl font-semibold text-gray-900"}`,style:n?a:{},children:"Volunteera"})})}),e.jsxs("div",{className:"hidden sm:flex sm:items-center sm:space-x-6",children:[e.jsx(m,{to:"/",className:"px-3 py-2 text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors",children:"Home"}),e.jsx(m,{to:"/browse",className:"px-3 py-2 text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors",children:"Browse"}),t&&e.jsxs(e.Fragment,{children:[e.jsx(m,{to:"/dashboard",className:"px-3 py-2 text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors",children:"Dashboard"}),t.is_organization&&e.jsxs(m,{to:"/opportunities/create",className:"px-4 py-2 text-sm font-medium rounded-full text-white bg-green-600 hover:bg-green-700 transition-colors flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Create Opportunity"]})]}),t?e.jsxs("div",{className:"relative ml-3 flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center",children:[t.is_organization&&e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full",children:"Organization"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:t.email})]}),e.jsx("button",{onClick:d,className:"px-4 py-2 text-sm font-medium rounded-full text-white bg-gray-900 hover:bg-gray-800 transition-colors",children:"Logout"})]}):e.jsxs(e.Fragment,{children:[e.jsx(m,{to:"/login",className:"px-3 py-2 text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors",children:"Login"}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>p(!c),onBlur:()=>setTimeout(()=>p(!1),100),className:"ml-2 px-4 py-2 text-sm font-medium rounded-full text-white bg-gray-900 hover:bg-gray-800 transition-colors flex items-center",children:["Register",e.jsx("svg",{className:`ml-2 h-4 w-4 transition-transform ${c?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),c&&e.jsxs(R.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute right-0 mt-2 w-48 rounded-lg shadow-lg bg-white ring-1 ring-black ring-opacity-5",children:[e.jsxs(m,{to:"/register",state:{type:"volunteer"},className:"block px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 rounded-t-lg flex items-center",children:[e.jsx("span",{className:"text-lg mr-2",children:"🤝"}),"I'm a Volunteer"]}),e.jsxs(m,{to:"/register",state:{type:"organization"},className:"block px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 rounded-b-lg flex items-center",children:[e.jsx("span",{className:"text-lg mr-2",children:"🏢"}),"I'm an Organization"]})]})]})]}),e.jsx(m,{to:"/about",className:"px-3 py-2 text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors",children:"About Us"})]}),e.jsx("div",{className:"sm:hidden flex items-center",children:e.jsxs("button",{onClick:()=>r(!l),className:"inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100",children:[e.jsx("span",{className:"sr-only",children:"Open main menu"}),e.jsx("svg",{className:`${l?"hidden":"block"} h-6 w-6`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})}),e.jsx("svg",{className:`${l?"block":"hidden"} h-6 w-6`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})})]})})}),e.jsx("div",{className:`${l?"block":"hidden"} sm:hidden`,children:e.jsxs("div",{className:"pt-2 pb-3 space-y-1",children:[e.jsx(m,{to:"/",className:"block px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50",children:"Home"}),e.jsx(m,{to:"/browse",className:"block px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50",children:"Browse"}),t&&e.jsx(m,{to:"/dashboard",className:"block px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50",children:"Dashboard"}),t&&t.is_organization&&e.jsx(m,{to:"/opportunities/create",className:"block px-3 py-2 text-base font-medium text-green-600 hover:text-green-700 hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Create Opportunity"]})}),t?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"px-3 py-2",children:[t.is_organization&&e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded-full",children:"Organization"}),e.jsx("span",{className:"block mt-1 text-sm font-medium text-gray-700",children:t.email})]}),e.jsx("button",{onClick:d,className:"block w-full text-left px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50",children:"Logout"})]}):e.jsxs(e.Fragment,{children:[e.jsx(m,{to:"/login",className:"block px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50",children:"Login"}),e.jsxs("div",{className:"px-3 py-2 space-y-1",children:[e.jsx(m,{to:"/register",state:{type:"volunteer"},className:"block px-4 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50",children:"Register as Volunteer"}),e.jsx(m,{to:"/register",state:{type:"organization"},className:"block px-4 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50",children:"Register as Organization"})]})]})]})})]})},se=({children:n})=>{const a=U(),{user:t,login:i}=E();return Y({onSuccess:async r=>{try{const o=await fetch("/api/auth/google/callback/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({credential:r.credential,user_type:"volunteer"})}),x=await o.json();if(!o.ok)throw new Error(x.error||"Login failed");localStorage.setItem("access_token",x.access),localStorage.setItem("refresh_token",x.refresh),i(x.user),a("/dashboard")}catch(o){console.error("Google One Tap error:",o),alert("Login failed: "+o.message)}},onError:r=>{console.error("Google One Tap login failed:",r),alert("Google login failed. Please try again.")},disabled:!!t,auto_select:!0,use_fedcm_for_prompt:!0,cancel_on_tap_outside:!1}),n};function ie({children:n}){return e.jsxs("html",{lang:"en",children:[e.jsxs("head",{children:[e.jsx("meta",{charSet:"UTF-8"}),e.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0"}),e.jsx("title",{children:"Volunterra"}),e.jsx(V,{}),e.jsx(D,{})]}),e.jsxs("body",{children:[n,e.jsx(F,{}),e.jsx(H,{})]})]})}const ae=W(function(){const[a,t]=s.useState(!1),[i,l]=s.useState(0);s.useEffect(()=>{const o=()=>{const x=window.scrollY;t(x>50),l(x*.2)};return window.addEventListener("scroll",o),()=>window.removeEventListener("scroll",o)},[]);const r={backgroundPosition:`${i}% 50%`};return e.jsx(q,{clientId:"1032409090840-gus43isikcnuq4n365l7gocm53h725dl.apps.googleusercontent.com",children:e.jsx(K,{children:e.jsx(se,{children:e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(te,{isScrolled:a,gradientStyle:r}),e.jsx(ee,{mode:"wait",children:e.jsx("main",{className:"pt-16",children:e.jsx(A,{})})})]})})})})});export{ie as Layout,ae as default};
