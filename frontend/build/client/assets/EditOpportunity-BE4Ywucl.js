import{w as E}from"./with-props-BqwZr1IK.js";import{r as i,a as _,j as e,u as S}from"./chunk-IR6S3I6Y-C6Zvu3tq.js";import{A as q,M,a as A}from"./index.modern-DddIrP7d.js";import{a as j}from"./api-BXsSQKvn.js";import{P as y}from"./PageTransition-1p6Ne89E.js";import{S as L}from"./LoadingSpinner-CGbvDqwE.js";import"./index-CUe7o6jQ.js";import"./proxy-7hmYPAw3.js";const I={lat:51.5074,lng:-.1278},P=({currentData:n})=>{const[t,l]=i.useState({}),[x,m]=i.useState(!0),[v,w]=i.useState(null),p=_();i.useEffect(()=>{if(n){l(n),w(n.id),m(!1);const a=n.latitude,o=n.longitude;f({lat:a,lng:o})}},[n]);const[h,f]=i.useState(null),[g,b]=i.useState(""),r=a=>{const{name:o,value:d}=a.target;l(c=>({...c,[o]:d}))},N=async a=>{const o=a.latLng.lat(),d=a.latLng.lng();f({lat:o,lng:d}),l(s=>({...s,latitude:o,longitude:d}));const c=new window.google.maps.Geocoder,u={lat:o,lng:d};try{const s=await c.geocode({location:u});s.results[0]&&l(C=>({...C,location_name:s.results[0].formatted_address}))}catch(s){console.error("Geocoding failed:",s)}},k=async a=>{var o,d,c,u;a.preventDefault(),b("");try{(await j.post(`/opportunities/${v}/`,t)).status===201&&p("/dashboard")}catch(s){console.error("Error response:",(o=s.response)==null?void 0:o.data),((d=s.response)==null?void 0:d.status)===403?b("You must be logged in as an organization to edit opportunities"):b(((u=(c=s.response)==null?void 0:c.data)==null?void 0:u.error)||"Failed to edit opportunity")}};return e.jsx(y,{children:x?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx(L,{})}):e.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Edit Opportunity"}),g&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:g}),e.jsxs("form",{onSubmit:k,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Title"}),e.jsx("input",{type:"text",name:"title",value:t.title,onChange:r,required:!0,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),e.jsx("textarea",{name:"description",value:t.description,onChange:r,required:!0,rows:"4",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Requirements"}),e.jsx("textarea",{name:"requirements",value:t.requirements,onChange:r,required:!0,rows:"4",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Average Start Time (24 hour clock)"}),e.jsx("input",{type:"number",max:24,min:0,name:"start_time",value:t.start_time,onChange:r,required:!0,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Average End Time (24 hour clock)"}),e.jsx("input",{type:"number",max:24,min:0,name:"end_time",value:t.end_time,onChange:r,required:!0,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Estimated Duration (In Days)"}),e.jsx("input",{type:"number",min:0,name:"estimated_duration",value:t.duration,onChange:r,required:!0,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Start Date"}),e.jsx("input",{type:"datetime-local",name:"start_date",value:t.start_date,onChange:r,required:!0,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"End Date"}),e.jsx("input",{type:"datetime-local",name:"end_date",value:t.end_date,onChange:r,required:!0,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Capacity"}),e.jsx("input",{type:"number",min:0,name:"capacity",value:t.capacity,onChange:r,required:!0,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Estimated Effort"}),e.jsxs("select",{id:"effort",value:t.estimated_effort_ranking,name:"estimated_effort_ranking",onChange:r,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Location"}),e.jsx("div",{className:"mt-2 h-[400px] w-full",children:e.jsx(q,{apiKey:"AIzaSyB0bbNwMEr4WRWFGAB-MqtkRGKK5dFXbJs",children:e.jsx(M,{defaultCenter:I,defaultZoom:13,reuseMaps:!0,onClick:a=>N(a.detail.latLng),mapId:"107f378fc363e5a7",children:h&&e.jsx(A,{position:h})})})}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Click on the map to set the location"})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx("button",{type:"button",onClick:()=>p(-1),className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:"Save Changes"})]})]})]})})},F=()=>{const[n,t]=i.useState(null),{id:l}=S();return i.useEffect(()=>{async function x(){try{const m=await j.get(`/opportunities/${l}/`);t(m)}catch(m){console.error("Error fetching opportunities:",m)}}l&&x()},[l]),e.jsx(y,{children:e.jsx("div",{className:"min-h-screen bg-gray-50 py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsx(P,{currentData:n})})})})},B=E(F);export{B as default};
