import{w as A}from"./proxy-BvCMkRSn.js";import{a,n as e}from"./chunk-HA7DTUK3-Dw2W5fJk.js";import{P as B}from"./PageTransition-DzrlKaVj.js";import{a as o}from"./api-BXsSQKvn.js";import{u as I}from"./UserContext-CLETiZQn.js";import{S as P}from"./LoadingSpinner-p_K9Qy2C.js";const T=()=>{const[N,u]=a.useState(!0),[f,w]=a.useState([]),[b,_]=a.useState([]),[S,R]=a.useState([]),[k,C]=a.useState([]),{user:c}=I(),[x,F]=a.useState(null),[g,m]=a.useState(null);let l=0;function E(){let s=document.getElementById("searchBar").value.toLowerCase();document.querySelectorAll(".user").forEach(n=>{n.textContent.toLowerCase().includes(s)?n.style.display="block":n.style.display="none"})}const d=async()=>{try{if(u(!0),!c){console.error("User is null. Cannot fetch data.");return}const s=await o.get("/volunteer/list/"),r=s;let n=s;r.forEach(t=>{t.email===c.email&&(l=t.id,F(t.id))});const y=await o.get("/volunteer/"+l+"/");_(y.friends);const D=y.friends;n=n.filter(t=>!D.some(i=>i.id===t.id)),n=n.filter(t=>t.id!==l);const h=await o.get("/friendship/list/pending/");n=n.filter(t=>!h.some(i=>i.from_volunteer===l&&i.to_volunteer===t.id||i.to_volunteer===l&&i.from_volunteer===t.id));const U=h.filter(t=>t.from_volunteer===l&&t.to_volunteer!==l);let v=[];for(const t of U){const i=await o.get("/volunteer/"+t.to_volunteer+"/");v.push(i)}R(v);const L=h.filter(t=>t.to_volunteer===l&&t.from_volunteer!==l);let j=[];for(const t of L){const i=await o.get("/volunteer/"+t.from_volunteer+"/");j.push(i)}C(j),w(n)}catch(s){console.error("Error fetching opportunities:",s)}finally{u(!1)}};a.useEffect(()=>{c&&d()},[c]);const p=async s=>{try{const r=await o.delete(`/friendship/delete/${s}/${x}/`);d(),m(r.message),console.log(r.message)}catch(r){console.error("Error deleting friendship:",r)}},q=async s=>{try{const r=await o.post(`/friendship/create/${s}/${x}/`);d(),m(r.message)}catch(r){console.error("Error creating friendship:",r)}},$=async s=>{try{const r=await o.post(`/friendship/accept/${s}/${x}/`,{headers:{"Content-Type":"application/json"}});d(),m(r.message)}catch(r){console.error("Error creating friendship:",r)}};return e.jsx(B,{children:e.jsx("div",{className:"min-h-screen bg-white -mt-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[g&&e.jsx("p",{className:"fixed-top text-center",role:"alert",children:g}),e.jsx("h1",{className:"text-3xl font-semibold text-gray-900",children:"Friends"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Discover and manage friends"})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[e.jsx("div",{className:"lg:w-64 flex-shrink-0",children:e.jsx("div",{className:"sticky top-24 space-y-8",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:" Your Friends"}),e.jsx("div",{className:"space-y-2",children:b.map(s=>e.jsxs("div",{className:"w-full flex justify-between items-center px-4 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-50 rounded-lg transition-colors",children:[e.jsx("span",{children:s.display_name}),e.jsx("button",{className:"inline-flex items-center px-4 py-2 text-sm font-medium rounded-full text-white bg-red-900 hover:bg-gray-800 transition-colors",onClick:()=>p(s.id),children:"Remove"})]},s.id))})]})})}),e.jsx("div",{className:"lg:w-64 flex-shrink-0",children:e.jsx("div",{className:"sticky top-24 space-y-8",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:" Sent Requests"}),e.jsx("div",{className:"space-y-2",children:S.map(s=>e.jsxs("div",{className:"w-full flex justify-between items-center px-4 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-50 rounded-lg transition-colors",children:[e.jsx("span",{children:s.display_name}),e.jsx("button",{className:"inline-flex items-center px-4 py-2 text-sm font-medium rounded-full text-white bg-red-900 hover:bg-gray-800 transition-colors",onClick:()=>p(s.id),children:"Cancel"})]},s.id))})]})})}),e.jsx("div",{className:"lg:w-64 flex-shrink-0",children:e.jsx("div",{className:"sticky top-24 space-y-8",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:" Friend Requests"}),e.jsx("div",{className:"space-y-2",children:k.map(s=>e.jsxs("div",{className:"w-full flex justify-between items-center px-4 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-50 rounded-lg transition-colors",children:[e.jsx("span",{children:s.display_name}),e.jsx("button",{className:"inline-flex items-center px-4 py-2 text-sm font-medium rounded-full text-white bg-red-900 hover:bg-gray-800 transition-colors",onClick:()=>p(s.id),children:"Decline"}),e.jsx("button",{className:"inline-flex items-center px-4 py-2 text-sm font-medium rounded-full text-white bg-green-900 hover:bg-gray-800 transition-colors",onClick:()=>$(s.id),children:"Accept"})]},s.id))})]})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{id:"searchBar",onKeyUp:E,type:"text",placeholder:"Search friends...",className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-200"})}),e.jsx("div",{className:"flex gap-4"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:N?e.jsx(P,{}):f.length===0?e.jsx("div",{className:"col-span-2 text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"No volunteers found"})}):f.map(s=>e.jsx("div",{className:"user",children:e.jsx("div",{className:"bg-white rounded-xl shadow-sm hover:shadow-md transition-shadow duration-200",children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"flex flex-col gap-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl",children:"ðŸ‘¤"}),e.jsx("div",{className:"flex-1",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.display_name})})]})}),e.jsx("div",{className:"mt-6 flex justify-between items-center",children:e.jsx("button",{onClick:()=>q(s.id),className:"inline-flex items-center px-4 py-2 text-sm font-medium rounded-full text-white bg-gray-900 hover:bg-gray-800 transition-colors",children:"Add"})})]})})},s.id))})]})]})]})})})},J=A(T);export{J as default};
